Copyright © 1999-2020, CSDN.NET, All Rights Reserved
打开APP
平人的进步日常
已关注
vi 命令使用详解 原创
2022-03-15 01:23:28
平人的进步日常 
码龄3年

已关注
1.三种工作模式
1.命令模式——通过命令对文件进行常规操作

打开文件时进入命令模式 （vi的入口）
通过命令对文件进行常规操作，如定位、翻页、复制、粘贴、删除等在图形界面下通过鼠标或快捷键实现的的操作。
2.末行模式——执行保存、退出等操作

若要退出vi返回控制台，需在末行模式下输入命令 （vi的出口）
3.编辑模式——正常编辑文字

三种模式的转换：
命令模式->编辑模式： i；编辑模式->命令模式：Esc；
命令模式->末行模式： :；末行模式->命令模式：Esc；

关闭文件：
末行模式下，输入wq（即保存后退出）

除了i进入编辑模式外，还提供了以下命令：

命令	英文	功能	常用
i	insert	在当前字符前插入文本	常用
I	insert	在行首插入文本	较常用
a	append	在当前字符后添加文本	\
A	append	在行末添加文本	较常用
o	\	在当前行后面插入一空行	常用
O	\	在当前行前面插入一空行	常用
2.末行模式命令
命令	英文	功能
w	write	保存
q	quit	退出，如果没有保存，不允许退出
q!	quit	强行退出，不保存退出
wq	write&quit	保存并退出
x	\	保存并退出
3.命令模式命令
3.1上、下、左、右（因为大佬认为应该把手指集中在一个区域）

命令	功能	手指
h	向左	食指
j	向下	食指
k	向上	中指
t	向右	无名指
3.2行内移动

命令	英文	功能
w	word	向后移动一个单词
b	back	向前移动一个单词
0	\	行首
^	\	行首，第一个不是空白字符的位置
$	\	行尾
3.3行数移动

命令	英文	功能
gg	go	文件顶部
G	go	文件末尾
数字gg	go	移动到数字对应行数
数字G	go	移动到数字对应行数
:数字	\	移动到数字对应行数
3.4屏幕移动

命令	英文	功能
Ctrl+b	back	向上翻页
Ctrl+f	forward	向下翻页
H	Head	屏幕顶部
M	Middle	屏幕中间
L	Low	屏幕底部
3.5段落移动

vi中使用空行来区分段落
在程序开发中，通常一段功能相关的代码会写在一起（之间没有空行）
命令	功能
{	上一段
}	下一段
3.6括号切换

命令	功能
%	括号匹配及切换
3.7标记

在开发时，某一块代码可能需要稍后处理，此时先使用m增加一个标记，可以在需要时快速地跳转回来
标记名称可以是a~z或A~Z之间地任意一个字母
添加了标记的行如果被删除，标记同时被删除
如果在其他行添加了相同标记名称的标记，之前添加的标记会被替换
例如：
命令	英文	功能
mx	mark	添加标记x
'x	\	直接定位到标记所在位置
3.8选中文本（可视模式）

命令	模式	功能
v	可视模式	从光标位置开始按照正常模式选择文本
V	可视行模式	选中光标经过的完整行
Ctrl+v	可视块模式	垂直方向选中文本
Esc可以放弃选中，回到命令模式
可视模式下，可以和移动命令连用，例如：ggVG能过选中所有内容
3.9撤销和恢复撤销

命令	英文	功能
u	undo	撤销上次命令
Ctrl+r	redo	恢复撤销的命令
3.10删除文本

命令	英文	功能
x	cut	删除光标所在字符
d(移动命令)	delete	删除移动命令对应的内容
dd	delete	删除光标所在行，可以ndd复制多行
D	delete	删除至行尾
如果使用可视模式已选中了一段文本，d和x都可以删除选中文本。
命令d、x类似与图形界面的剪切操作（Ctrl+x）。
删除命令可以和移动命令连用，以下是常见的组合：

dw从光标位置删除到单词末尾
d0从光标位置删除到一行的起始位置
d}从光标位置删除到段乱结尾
ndd从光标位置向下连续删除n行
d代码行G从光标所在行删除到指定代码行之间的所有代码
d‘a从光标所在行删除到标记a之间的所有代码
3.11复制粘贴

命令	英文	功能
y(移动命令)	copy	复制
yy	copy	复制一行，可以nyy复制多行
p	paste	粘贴
vi中的文本缓冲区和系统的剪贴板不是同一个（即在其他软件中使用Ctrl+c复制的内容，不能再vi中通过p粘贴）
可以在编辑模式下使用鼠标右键粘贴
3.12替换

命令	英文	功能	工作模式
r	replace	替换当前字符	命令模式
R	replace	替换当前行光标后的字符	替换模式
R可以进入替换模式，替换完成后，按Esc可以返回命令模式
替换命令的作用就是不用进入编辑模式，对文件进行轻量级的修改
3.13缩排和重复执行

命令	功能
>>	向右增加缩进
<<	向左增加缩进
.	重复上次命令
缩排命令在开发程序时，统一增加代码的缩进比较有用
在可是模式下，缩排命令只需要使用一个>或<
3.14查找

常规查找

命令	功能
/str	查找str
n	查找下一个
N	查找上一个
如果不想看到高亮现实，可以随便查找一个文件中不存在的内容即可
单词快速匹配

命令	功能
*	向后查找当前光标所在单词
#	向前查找当前光标所在单词
3.15查找并替换
需要在末行模式下执行：%s///g

3.15.1全局替换
：%s/旧文本/新文本/g
3.15.2可视区域替换
先选中要替换文字的范围
：%s/旧文本/新文本/g
3.15.3确认替换
：%s/旧文本/新文本/gc
会出现提示：
y-yes 替换
n-no 不替换
a-all 替换所有
q-quit 退出替换
l-last 最后一个，并把光标移动到行首
^E 向下滚屏
^Y 向上滚屏

4.拓展
4.1连续输入N个同样的字符
例如：输入10个*

命令模式下，输入10
i进入编辑模式
输入*
Esc返回命令模式
4.2末行命令拓展

命令	英文	功能
:e.	edit	会打开内置的文件浏览器，浏览当前目录下的文件
:n 文件名	new	新建文件
:w. 文件名	write	另存为，但是仍然编辑当前文件，并不会切换文件
切换文件之前，必须保证当前这个文件已经被保存！

4.3分屏命令

命令	英文	功能
:sp[文件名]	split	横向增加分屏
:vsp[文件名]	verdical split	竖向增加分屏
切换分屏窗口都是基于Ctrl+w这个快捷键，w对应的英文如下：

命令	英文	功能
w	window	切换到下一个窗口
r	reverse	互换窗口
c	close	关闭当前窗口，但是不能关闭最后一个窗口
q	quit	退出当前窗口，如果是最后一个窗口，则关闭vi
o	other	关闭其他窗口

